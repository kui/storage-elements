(function(h){function j(l){if(k[l])return k[l].exports;var m=k[l]={exports:{},id:l,loaded:!1};return h[l].call(m.exports,m,m.exports,j),m.loaded=!0,m.exports}var k={};return j.m=h,j.c=k,j.p="",j(0)})([function(h,j,k){"use strict";var l=k(5),m=function(o){return o&&o.__esModule?o:{default:o}}(l);m.default.register()},function(h,j){"use strict";j.__esModule=!0,j.sleep=function(n){var o=void 0;return new k(p=>{o=setTimeout(()=>p(),n)},()=>{clearTimeout(o)})},j.dedup=function(n){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:(p,q)=>p===q;return n.reduce((p,q)=>{if(p.some(r=>o(r,q)));return p.concat(q)},[])},j.subtractSet=function(n,o){return new Set(Array.from(n).filter(p=>!o.has(p)))};class k extends Promise{constructor(m,n){super(m),this.cancellFunction=n}cancell(){this.cancellFunction()}}j.CancellablePromise=k;class l extends Map{*flattenValues(){for(var m=this.values(),n=Array.isArray(m),o=0,m=n?m:m[Symbol.iterator]();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{if(o=m.next(),o.done)break;p=o.value}var q=p;for(var r=q,s=Array.isArray(r),t=0,r=s?r:r[Symbol.iterator]();;){var v;if(s){if(t>=r.length)break;v=r[t++]}else{if(t=r.next(),t.done)break;v=t.value}var w=v;yield w}}}}j.ArrayValueMap=class extends l{add(n,o){var p=this.get(n);return p||(p=[],this.set(n,p)),p.push(o),this}},j.SetValueMap=class extends l{add(n,o){var p=this.get(n);return p||(p=new Set,this.set(n,p)),p.add(o),this}}},function(h,j){"use strict";function k(p,q){if(l[p])throw Error(`Already registered handler for "${p}"`);l[p]=q}j.__esModule=!0,j.registerHandler=k,j.findHandler=function(q){return l[q]},j.listHandlers=function(){return Object.entries(l)};var l={};class m{constructor(p){this.storage=p}read(p){return Promise.resolve(this.storage.getItem(p))}write(p,q){return this.storage.setItem(p,q),Promise.resolve()}remove(p){return this.storage.removeItem(p),Promise.resolve()}}j.WebStorageAreaHandler=m,"undefined"!=typeof localStorage&&k("local-storage",new m(localStorage)),"undefined"!=typeof sessionStorage&&k("session-storage",new m(sessionStorage));class n{constructor(p){this.storage=p}read(p){return new Promise(q=>this.storage.get(p,r=>q(r[p])))}write(p,q){return new Promise(r=>this.storage.set({[p]:q},r))}remove(p){return new Promise(q=>this.storage.remove(p,q))}}j.ChromeStorageAreaHandler=n;class o extends n{constructor(p){super(p),this.delayMillis=3.6e6/p.MAX_WRITE_OPERATIONS_PER_HOUR+500,this.updatedEntries=null}write(p,q){return null==this.updatedEntries?(this.updatedEntries={[p]:q},setTimeout(()=>{null==this.updatedEntries||(this.storage.set(this.updatedEntries),this.updatedEntries=null)},this.delayMillis),Promise.resolve()):(this.updatedEntries[p]=q,Promise.resolve())}}j.BatchWriteChromeStorageAreaHandler=o,"undefined"!=typeof chrome&&chrome.storage&&(chrome.storage.local&&k("chrome-local",new n(chrome.storage.local)),chrome.storage.sync&&k("chrome-sync",new o(chrome.storage.sync)))},function(h,j,k){"use strict";function l(s){return function(){var t=s.apply(this,arguments);return new Promise(function(v,w){function x(y,z){try{var A=t[y](z),B=A.value}catch(C){return void w(C)}return A.done?void v(B):Promise.resolve(B).then(function(C){x("next",C)},function(C){x("throw",C)})}return x("next")})}}j.__esModule=!0;var m=(()=>{var s=l(function*(t,v){yield Promise.all(v.map((()=>{var w=l(function*(x){yield o(t,x),yield p(t,x)});return function(){return w.apply(this,arguments)}})()))});return function(){return s.apply(this,arguments)}})(),n=(()=>{var s=l(function*(t,v){for(;t.lock;)yield t.lock;t.lock=v(),yield t.lock,t.lock=null});return function(){return s.apply(this,arguments)}})(),o=(()=>{var s=l(function*(t,v){var w=v.name,x=yield t.s.read(w),y=t.v.get(v);y||(y={name:v.name,value:null},t.v.set(v,y)),(y.name!==w||y.value!==x)&&(t.f.write(v,x),y.name=w,y.value=x)});return function(){return s.apply(this,arguments)}})(),p=(()=>{var s=l(function*(t,v){var w=v.name,x=t.f.read(v),y=t.v.get(v);y||(y={name:v.name,value:null},t.v.set(v,y)),(y.name!==w||y.value!==x)&&(null==x?yield t.s.remove(w):yield t.s.write(w,x),y.name=w,y.value=x)});return function(){return s.apply(this,arguments)}})(),q=k(1),r=function(t){if(t&&t.__esModule)return t;var v={};if(null!=t)for(var w in t)Object.prototype.hasOwnProperty.call(t,w)&&(v[w]=t[w]);return v.default=t,v}(q);j.default=class{constructor(t,v){this.v=new Map,this.s=t,this.f=v,this.lock=null}sync(t){var v=this;return l(function*(){yield n(v,function(){return m(v,t)})})()}submit(t){var v=this;return l(function*(){yield n(v,function(){return Promise.all(t.map((()=>{var w=l(function*(x){yield p(v,x)});return function(){return w.apply(this,arguments)}})()))})})()}scan(t){var v=this;return l(function*(){yield n(v,l(function*(){var w=r.subtractSet(new Set(t),new Set(v.v.keys()));yield m(v,Array.from(w))}))})()}remove(t){var v=this;return l(function*(){yield n(v,l(function*(){for(var w=t,x=Array.isArray(w),y=0,w=x?w:w[Symbol.iterator]();;){var z;if(x){if(y>=w.length)break;z=w[y++]}else{if(y=w.next(),y.done)break;z=y.value}var A=z;v.v.delete(A)}}))})()}}},function(h,j,k){"use strict";function l(H){if(H&&H.__esModule)return H;var I={};if(null!=H)for(var J in H)Object.prototype.hasOwnProperty.call(H,J)&&(I[J]=H[J]);return I.default=H,I}function m(H){return function(){var I=H.apply(this,arguments);return new Promise(function(J,K){function L(M,N){try{var O=I[M](N),P=O.value}catch(Q){return void K(Q)}return O.done?void J(P):Promise.resolve(P).then(function(Q){L("next",Q)},function(Q){L("throw",Q)})}return L("next")})}}function n(H){return class extends H{get area(){return t(this,"area")}set area(I){v(this,"area",I)}constructor(){super()}createdCallback(){var I=this;this.isInitLoad=!0,this.addEventListener("change",()=>y(this)),window.addEventListener("unload",()=>y(this)),m(function*(){for(;;)yield A.sleep(500),yield y(I),q(I)})()}attachedCallback(){0===this.length&&s(this),w(this),q(this)}static get observedAttributes(){return["area"]}attributeChangedCallback(I){"area"===I?w(this):void 0}}}function o(H,I){H.value===I||(H.value=I,q(H))}function p(H){return H.value}function q(H){var I=H.form;null==I||I.setAttribute("area",H.value)}function r(H){var I=H.area;if(!I)return console.debug("Require 'area' attribute",H),null;var J=C.findHandler(I);return J?J:(console.debug("No such area handler: area=%s, this=%s",H.area,H),null)}function s(H){for(var I=C.listHandlers(),J=Array.isArray(I),K=0,I=J?I:I[Symbol.iterator]();;){var L;if(J){if(K>=I.length)break;L=I[K++]}else{if(K=I.next(),K.done)break;L=K.value}var M=L,N=M[0],O=document.createElement("option");O.innerHTML=N,H.appendChild(O)}}function t(H,I){var J=H.getAttribute(I);return J?J:""}function v(H,I,J){null==J||H.setAttribute(I,J)}j.__esModule=!0;var w=(()=>{var H=m(function*(I){if(0!==I.options.length){I.binder=null;var J=r(I);J&&(I.binder=new E.default(J,{write:o,read:p}),I.isInitLoad?(I.isInitLoad=!1,yield y(I)):yield x(I))}});return function(){return H.apply(this,arguments)}})(),x=(()=>{var H=m(function*(I){I.binder&&(yield I.binder.submit([I]))});return function(){return H.apply(this,arguments)}})(),y=(()=>{var H=m(function*(I){I.binder&&(yield I.binder.sync([I]))});return function(){return H.apply(this,arguments)}})();j.mixinAreaSelect=n;var z=k(1),A=l(z),B=k(2),C=l(B),D=k(3),E=function(I){return I&&I.__esModule?I:{default:I}}(D),F=n(HTMLSelectElement);class G extends F{static get extends(){return"select"}}j.default=G},function(h,j,k){"use strict";function l(P){return P&&P.__esModule?P:{default:P}}function m(P){if(P&&P.__esModule)return P;var Q={};if(null!=P)for(var R in P)Object.prototype.hasOwnProperty.call(P,R)&&(Q[R]=P[R]);return Q.default=P,Q}function n(P){return function(){var Q=P.apply(this,arguments);return new Promise(function(R,S){function T(U,V){try{var W=Q[U](V),X=W.value}catch(Y){return void S(Y)}return W.done?void R(X):Promise.resolve(X).then(function(Y){T("next",Y)},function(Y){T("throw",Y)})}return T("next")})}}function o(P){return class extends P{get autosync(){var Q=parseInt(x(this,"autosync"));return 0<Q?Q:700}set autosync(Q){y(this,"autosync",Q)}get area(){return x(this,"area")}set area(Q){y(this,"area",Q)}constructor(){super()}createdCallback(){var Q=this;this.isInitLoad=!0,this.componentObservers=new Map,E(this),this.addEventListener("submit",R=>{R.preventDefault(),A(this)}),window.addEventListener("unload",()=>{p(this)&&B(this)}),new MutationObserver(R=>{console.debug("scan by form MutationObserver: ",this),C(this);var S=z(R.map(ca=>ca.addedNodes)).filter(ca=>ca instanceof HTMLElement);if(0<S.length)for(var T=S,U=Array.isArray(T),V=0,T=U?T:T[Symbol.iterator]();;){var W;if(U){if(V>=T.length)break;W=T[V++]}else{if(V=T.next(),V.done)break;W=V.value}var X=W;q(this,X)}var Y=z(R.map(ca=>ca.removedNodes)).filter(ca=>ca instanceof HTMLElement);if(0<Y.length){D(this,Y.filter(ca=>ca.name));for(var Z=Y,$=Array.isArray(Z),_=0,Z=$?Z:Z[Symbol.iterator]();;){var aa;if($){if(_>=Z.length)break;aa=Z[_++]}else{if(_=Z.next(),_.done)break;aa=_.value}var ba=aa;r(this,ba)}}}).observe(this,{childList:!0,subtree:!0}),C(this),n(function*(){for(;;)yield G.sleep(Q.autosync),p(Q)?yield B(Q):yield C(Q)})()}attachedCallback(){C(this)}static get observedAttributes(){return["autosync","area"]}attributeChangedCallback(Q){switch(Q){case"autosync":break;case"area":E(this);}}}}function p(P){return P.hasAttribute("autosync")}function q(P,Q){var R=[Q,...Array.from(Q.querySelectorAll("*"))].filter(Y=>null!=Y.value&&null!=Y.name),S=function(Z){var $=new MutationObserver(()=>B(P,[Z]));$.observe(Z,{attributes:!0,atributeFilter:["name"]}),P.componentObservers.set(Z,$)};for(var T=R,U=Array.isArray(T),V=0,T=U?T:T[Symbol.iterator]();;){var W;if(U){if(V>=T.length)break;W=T[V++]}else{if(V=T.next(),V.done)break;W=V.value}var X=W;S(X)}}function r(P,Q){var R=[Q,...Array.from(Q.querySelectorAll("*"))];for(var S=R,T=Array.isArray(S),U=0,S=T?S:S[Symbol.iterator]();;){var V;if(T){if(U>=S.length)break;V=S[U++]}else{if(U=S.next(),U.done)break;V=U.value}var W=V,X=P.componentObservers.get(W);null==X||(P.componentObservers.delete(W),X.disconnect())}}function s(P){return Array.from(P.elements).filter(Q=>Q.name).filter(Q=>!(Q instanceof M.default))}function t(P,Q){var R=P.type;return"checkbox"===R||"radio"===R?void(P.checked=Q===P.value):void(null==Q||null==P.value||(P.value=Q))}function v(P){var Q=P.type;if("checkbox"===Q||"radio"===Q){if(P.checked)return P.value;var R=P.dataset.uncheckedValue;return R?R:""}return P.value}function w(P){var Q=P.area;if(!Q)return console.debug("Require 'area' attribute",P),null;var R=K.findHandler(Q);return R?R:(console.debug("No such area handler: area=%s, this=%o",P.area,P),null)}function x(P,Q){var R=P.getAttribute(Q);return R?R:""}function y(P,Q,R){null==R||P.setAttribute(Q,R)}function z(P){return Array.from(function*(){for(var Q=P,R=Array.isArray(Q),S=0,Q=R?Q:Q[Symbol.iterator]();;){var T;if(R){if(S>=Q.length)break;T=Q[S++]}else{if(S=Q.next(),S.done)break;T=S.value}var U=T;for(var V=U,W=Array.isArray(V),X=0,V=W?V:V[Symbol.iterator]();;){var Y;if(W){if(X>=V.length)break;Y=V[X++]}else{if(X=V.next(),X.done)break;Y=X.value}var Z=Y;yield Z}}}())}j.__esModule=!0;var A=(()=>{var P=n(function*(Q){Q.binder&&(yield Q.binder.submit(s(Q)))});return function(){return P.apply(this,arguments)}})(),B=(()=>{var P=n(function*(Q,R){Q.binder&&(yield Q.binder.sync(R?R:s(Q)))});return function(){return P.apply(this,arguments)}})(),C=(()=>{var P=n(function*(Q){Q.binder&&(yield Q.binder.scan(s(Q)))});return function(){return P.apply(this,arguments)}})(),D=(()=>{var P=n(function*(Q,R){Q.binder&&(yield Q.binder.remove(R))});return function(){return P.apply(this,arguments)}})(),E=(()=>{var P=n(function*(Q){Q.binder=null;var R=w(Q);R&&(Q.binder=new I.default(R,{write:t,read:v}),Q.isInitLoad?(Q.isInitLoad=!1,yield B(Q)):yield A(Q),Q.dispatchEvent(new CustomEvent("storage-form-init",{detail:{target:Q}})))});return function(){return P.apply(this,arguments)}})();j.mixinStorageForm=o;var F=k(1),G=m(F),H=k(3),I=l(H),J=k(2),K=m(J),L=k(4),M=l(L),N=o(HTMLFormElement);class O extends N{static get extends(){return"form"}static register(){document.registerElement("storage-form",O),document.registerElement("area-select",M.default)}}j.default=O}]);
//# sourceMappingURL=storage-elements.js.map